import { create } from "zustand";
import { v4 as uuidv4 } from "uuid";
import {
  getTemplateSampleData,
  DEFAULT_TEMPLATE,
} from "../components/builder/templates";

// Factory function for default section templates
const createDefaultSections = () => ({
  header: {
    id: "header",
    type: "header",
    locked: true,
    data: {
      fullName: "Your Name",
      title: "Professional Title",
      email: "email@example.com",
      phone: "+1 234 567 890",
      location: "City, Country",
      linkedin: "",
      website: "",
    },
  },
  summary: {
    id: "summary",
    type: "summary",
    data: {
      content:
        "A brief professional summary highlighting your key qualifications, experience, and career objectives.",
    },
  },
  experience: {
    id: "experience",
    type: "experience",
    data: {
      items: [
        {
          id: uuidv4(),
          title: "Job Title",
          company: "Company Name",
          location: "City, Country",
          startDate: "MM/YYYY",
          endDate: "Present",
          description:
            "Describe your responsibilities and achievements in this role.",
          bullets: [],
        },
      ],
    },
  },
  education: {
    id: "education",
    type: "education",
    data: {
      items: [
        {
          id: uuidv4(),
          degree: "Degree Name",
          institution: "University/College Name",
          location: "City, Country",
          startDate: "MM/YYYY",
          endDate: "MM/YYYY",
          gpa: "",
          description: "",
        },
      ],
    },
  },
  skills: {
    id: "skills",
    type: "skills",
    data: {
      title: "Skills",
      items: ["Skill 1", "Skill 2", "Skill 3", "Skill 4", "Skill 5"],
    },
  },
  projects: {
    id: "projects",
    type: "projects",
    data: {
      items: [
        {
          id: uuidv4(),
          name: "Project Name",
          subtitle: "Project Type",
          date: "MM/YYYY",
          description: "Brief description of the project and your role.",
          bullets: [],
          link: "",
        },
      ],
    },
  },
});

// Factory function for additional section templates
const createSectionTemplates = () => ({
  certifications: {
    type: "certifications",
    label: "Certifications",
    icon: "Award",
    data: {
      items: [
        {
          id: uuidv4(),
          name: "Certification Name",
          issuer: "Issuing Organization",
          date: "MM/YYYY",
          credentialId: "",
        },
      ],
    },
  },
  languages: {
    type: "languages",
    label: "Languages",
    icon: "Globe",
    data: {
      items: [
        { id: uuidv4(), language: "English", proficiency: "Native" },
        { id: uuidv4(), language: "Spanish", proficiency: "Intermediate" },
      ],
    },
  },
  volunteering: {
    type: "volunteering",
    label: "Volunteering",
    icon: "Heart",
    data: {
      items: [
        {
          id: uuidv4(),
          role: "Volunteer Role",
          organization: "Organization Name",
          date: "MM/YYYY - MM/YYYY",
          description: "Description of your volunteer work.",
        },
      ],
    },
  },
  awards: {
    type: "awards",
    label: "Awards",
    icon: "Trophy",
    data: {
      items: [
        {
          id: uuidv4(),
          title: "Award Title",
          issuer: "Issuing Organization",
          date: "MM/YYYY",
          description: "",
        },
      ],
    },
  },
  interests: {
    type: "interests",
    label: "Interests",
    icon: "Sparkles",
    data: {
      items: ["Interest 1", "Interest 2", "Interest 3"],
    },
  },
  references: {
    type: "references",
    label: "References",
    icon: "Users",
    data: {
      items: [
        {
          id: uuidv4(),
          name: "Reference Name",
          title: "Title",
          company: "Company",
          email: "email@example.com",
          phone: "",
        },
      ],
    },
  },
  publications: {
    type: "publications",
    label: "Publications",
    icon: "BookOpen",
    data: {
      items: [
        {
          id: uuidv4(),
          title: "Publication Title",
          publisher: "Publisher",
          date: "MM/YYYY",
          link: "",
        },
      ],
    },
  },
  courses: {
    type: "courses",
    label: "Training / Courses",
    icon: "GraduationCap",
    data: {
      items: [
        {
          id: uuidv4(),
          name: "Course Name",
          provider: "Provider",
          date: "MM/YYYY",
        },
      ],
    },
  },
  socialLinks: {
    type: "socialLinks",
    label: "Find Me Online",
    icon: "Link",
    data: {
      items: [
        { id: uuidv4(), platform: "LinkedIn", url: "" },
        { id: uuidv4(), platform: "GitHub", url: "" },
        { id: uuidv4(), platform: "Portfolio", url: "" },
      ],
    },
  },
  strengths: {
    type: "strengths",
    label: "Strengths",
    icon: "Zap",
    data: {
      items: ["Strength 1", "Strength 2", "Strength 3", "Strength 4"],
    },
  },
  objective: {
    type: "objective",
    label: "Career Objective",
    icon: "Target",
    data: {
      content:
        "A brief career objective describing your goals and aspirations.",
    },
  },
  achievements: {
    type: "achievements",
    label: "Achievements",
    icon: "Medal",
    data: {
      items: [
        { id: uuidv4(), description: "Achievement 1" },
        { id: uuidv4(), description: "Achievement 2" },
      ],
    },
  },
  personalDetails: {
    type: "personalDetails",
    label: "Personal Details",
    icon: "User",
    data: {
      dob: "",
      languages: "",
      hobbies: "",
      address: "",
    },
  },
  technicalSkills: {
    type: "technicalSkills",
    label: "Technical Skills",
    icon: "Code",
    data: {
      categories: [
        { id: uuidv4(), name: "Frontend", skills: "HTML5, CSS3, JavaScript" },
        { id: uuidv4(), name: "Backend", skills: "Node.js, Express.js" },
        { id: uuidv4(), name: "Databases", skills: "MySQL, MongoDB" },
        { id: uuidv4(), name: "Tools", skills: "Git, VS Code" },
      ],
    },
  },
  custom: {
    type: "custom",
    label: "Custom Section",
    icon: "Plus",
    data: {
      title: "Custom Section",
      content: "Add your custom content here.",
    },
  },
});

// Template layouts
const templates = {
  basic: {
    id: "basic",
    name: "Basic",
    preview: "/templates/basic.png",
    layout: "single-column",
    headerStyle: "left-aligned",
    description: "Clean and simple template with teal accents",
  },
  modern: {
    id: "modern",
    name: "Modern",
    preview: "/templates/modern.png",
    layout: "single-column",
    headerStyle: "centered",
  },
  professional: {
    id: "professional",
    name: "Professional",
    preview: "/templates/professional.png",
    layout: "single-column",
    headerStyle: "left-aligned",
  },
  elegant: {
    id: "elegant",
    name: "Elegant",
    preview: "/templates/elegant.png",
    layout: "single-column",
    headerStyle: "left-aligned",
  },
  minimal: {
    id: "minimal",
    name: "Minimal",
    preview: "/templates/minimal.png",
    layout: "single-column",
    headerStyle: "left-aligned",
  },
  shraddha: {
    id: "shraddha",
    name: "Shraddha Khapra",
    preview: "/templates/shraddha.png",
    layout: "single-column",
    headerStyle: "centered",
    description: "Professional template with blue headers and yellow highlight",
  },
};

// Basic template data factory (based on the clean teal resume template)
const createBasicTemplateData = () => {
  return {
    sections: [
      {
        id: "header",
        type: "header",
        locked: true,
        data: {
          fullName: "Your Name",
          title: "",
          email: "youremail@gmail.com",
          phone: "91234XXXXX",
          location: "",
          linkedin: "",
          website: "",
        },
      },
      {
        id: uuidv4(),
        type: "objective",
        data: {
          content:
            "A hardworking and enthusiastic graduate looking for a role. Interested in learning new technologies and building user friendly applications.",
        },
      },
      {
        id: uuidv4(),
        type: "education",
        data: {
          items: [
            {
              id: uuidv4(),
              degree: "B.E in Computer Engineering",
              institution: "Lorem College of Engineering",
              location: "",
              startDate: "",
              endDate: "2025",
              gpa: "8.2 CGPA",
              description: "",
            },
            {
              id: uuidv4(),
              degree: "HSC Science",
              institution: "Ipsum Vidyalaya",
              location: "",
              startDate: "",
              endDate: "2021",
              gpa: "82%",
              description: "",
            },
            {
              id: uuidv4(),
              degree: "SSC",
              institution: "Ipsum Vidyalaya",
              location: "",
              startDate: "",
              endDate: "2019",
              gpa: "85%",
              description: "",
            },
          ],
        },
      },
      {
        id: uuidv4(),
        type: "technicalSkills",
        data: {
          categories: [
            {
              id: uuidv4(),
              name: "Frontend",
              skills: "HTML5, CSS3, JavaScript, Bootstrap, React.js",
            },
            { id: uuidv4(), name: "Backend", skills: "Node.js, Express.js" },
            {
              id: uuidv4(),
              name: "Databases",
              skills: "MySQL, MongoDB (basic)",
            },
            { id: uuidv4(), name: "Tools", skills: "Git, VS Code, Postman" },
          ],
        },
      },
      {
        id: uuidv4(),
        type: "strengths",
        data: {
          items: [
            "Good problem-solving skills",
            "Excellent Communication Skills",
            "Quick learner and adaptable",
            "Excellent knowledge of core subjects",
          ],
        },
      },
      {
        id: uuidv4(),
        type: "projects",
        data: {
          items: [
            {
              id: uuidv4(),
              name: "Online Grocery Store",
              subtitle: "Team size: 6 | Front End: React.js | Back End: MySQL",
              date: "April 2025",
              description:
                "A full stack web application for ordering groceries online with search, cart, and checkout features. Customers can browse products, add them to the cart, and make secure payments.",
              bullets: [],
              link: "",
            },
          ],
        },
      },
      {
        id: uuidv4(),
        type: "achievements",
        data: {
          items: [
            {
              id: uuidv4(),
              description:
                "Participated in various cultural events at school and college.",
            },
            {
              id: uuidv4(),
              description:
                "Won second place in Badminton during the college's annual sports day.",
            },
          ],
        },
      },
      {
        id: uuidv4(),
        type: "personalDetails",
        data: {
          dob: "02 July 2001",
          languages: "English, Hindi and Telugu",
          hobbies: "Reading books, Badminton",
          address: "Visakhapatnam, Andhra Pradesh 530003",
        },
      },
    ],
    sectionOrder: [],
    template: "basic",
    theme: {
      primaryColor: "#0d9488",
      accentColor: "#0d9488",
      fontFamily: "Inter",
      fontSize: "medium",
      pageMargins: 2,
      sectionSpacing: 1.5,
      lineHeight: 1.4,
      background: "plain",
    },
  };
};

// Shraddha Khapra template data factory (blue headers with yellow highlight)
const createShraddhaTemplateData = () => {
  return {
    sections: [
      {
        id: "header",
        type: "header",
        locked: true,
        data: {
          fullName: "AARAV PATEL",
          title: "",
          email: "aarav.patel.dev@email.com",
          phone: "+91 98765-43210",
          location: "",
          linkedin: "LinkedIn",
          website: "Portfolio",
          github: "GitHub",
        },
      },
      {
        id: uuidv4(),
        type: "education",
        data: {
          items: [
            {
              id: uuidv4(),
              degree: "Bachelor of Engineering in Computer Engineering",
              institution: "State Institute of Technology",
              location: "",
              startDate: "",
              endDate: "Present",
              gpa: "",
              description: "",
            },
          ],
        },
      },
      {
        id: uuidv4(),
        type: "experience",
        data: {
          items: [
            {
              id: uuidv4(),
              title: "Frontend Development Intern",
              company: "TechSolutions Pvt Ltd.",
              location: "",
              startDate: "Jun 2024",
              endDate: "Jul 2024",
              description: "",
              bullets: [
                "Collaborated with a 4-member development team to redesign and implement a company-wide internal dashboard using React.js, enhancing user workflows.",
                "Optimized API call efficiency by implementing debouncing techniques, reducing unnecessary server requests by 40% and improving application responsiveness.",
                "Translated Figma designs into pixel-perfect, high-quality code, developing clean, reusable components and rigorously adhering to responsive design principles across all devices.",
              ],
            },
          ],
        },
      },
      {
        id: uuidv4(),
        type: "projects",
        data: {
          items: [
            {
              id: uuidv4(),
              name: "ShopMate - E-Commerce Platform",
              subtitle: "",
              date: "Present",
              description: "",
              bullets: [
                "Engineered a full-stack e-commerce platform featuring robust product search, intuitive cart management, and secure user authentication for over 500 registered users.",
                "Integrated Stripe API for secure payment processing, achieving a 100% success rate in mock transactions and ensuring seamless checkout for users.",
                "Crafted a responsive user interface utilizing Tailwind CSS, enhancing mobile load speed by 25% and improving user experience on various devices.",
                "Leveraged Redux Toolkit for efficient global state management, streamlining shopping cart data handling across 20+ components.",
              ],
              link: "",
            },
            {
              id: uuidv4(),
              name: "ChatFlow - Realtime Messaging App",
              subtitle: "",
              date: "Present",
              description: "",
              bullets: [
                "Engineered a real-time messaging platform enabling users to create rooms and exchange messages with sub-second latency.",
                "Integrated Socket.io for bi-directional, real-time communication, successfully supporting up to 50 concurrent users per chat room.",
                "Implemented persistent message storage via MongoDB, ensuring seamless retrieval of complete chat history upon user login.",
                'Integrated real-time "typing indicators" and "online status" features, increasing user engagement and perceived interactivity by 30%.',
              ],
              link: "",
            },
          ],
        },
      },
      {
        id: uuidv4(),
        type: "technicalSkills",
        data: {
          categories: [
            {
              id: uuidv4(),
              name: "Languages",
              skills: "Java, JavaScript (ES6+), Python, SQL, HTML5, CSS3",
            },
            {
              id: uuidv4(),
              name: "Frameworks",
              skills:
                "React.js, Redux Toolkit, Tailwind CSS, Shadcn/ui, Bootstrap, Node.js, Express.js",
            },
            {
              id: uuidv4(),
              name: "Tools",
              skills: "Git, GitHub, Postman, VS Code, Vercel, Docker",
            },
          ],
        },
      },
    ],
    sectionOrder: [],
    template: "shraddha",
    theme: {
      primaryColor: "#2563eb",
      accentColor: "#eab308",
      fontFamily: "Inter",
      fontSize: "medium",
      pageMargins: 2,
      sectionSpacing: 1.5,
      lineHeight: 1.4,
      background: "plain",
    },
  };
};

// Default theme settings
const defaultTheme = {
  primaryColor: "#1e3a5f",
  accentColor: "#3b82f6",
  fontFamily: "Inter",
  fontSize: "medium",
  pageMargins: 2,
  sectionSpacing: 2,
  lineHeight: 1.5,
  background: "plain",
};

// Factory function for initial resume state
const createInitialResumeData = () => {
  const defaultSections = createDefaultSections();
  const sections = [
    { ...defaultSections.header },
    { ...defaultSections.summary, id: uuidv4() },
    { ...defaultSections.experience, id: uuidv4() },
    { ...defaultSections.education, id: uuidv4() },
    { ...defaultSections.skills, id: uuidv4() },
    { ...defaultSections.projects, id: uuidv4() },
  ];
  return {
    sections,
    sectionOrder: sections.map((s) => s.id),
    template: DEFAULT_TEMPLATE,
    theme: { ...defaultTheme },
    sectionSettings: {
      education: {
        showGPA: true,
        showLocation: true,
        showDescription: false,
      },
      experience: {
        showLocation: true,
        showBullets: true,
        showDescription: true,
      },
      projects: {
        showDate: true,
        showLink: true,
        showBullets: true,
        showTechnologies: true,
      },
      skills: {
        showCategories: true,
        showProficiency: false,
      },
    },
  };
};

const MAX_HISTORY = 50;

export const useBuildStore = create((set, get) => ({
  // Resume Data
  resumeData: createInitialResumeData(),

  // History for undo/redo
  history: [],
  historyIndex: -1,

  // UI State
  activePanel: null, // 'addSection' | 'rearrange' | 'templates' | 'design' | null
  selectedSectionId: null,
  isLoading: false,

  // Available templates and section templates
  templates,
  sectionTemplates: createSectionTemplates(),

  // Save state to history
  saveToHistory: () => {
    const { resumeData, history, historyIndex } = get();
    const newHistory = history.slice(0, historyIndex + 1);
    newHistory.push(JSON.parse(JSON.stringify(resumeData)));

    if (newHistory.length > MAX_HISTORY) {
      newHistory.shift();
    }

    set({
      history: newHistory,
      historyIndex: newHistory.length - 1,
    });
  },

  // Undo action
  undo: () => {
    const { history, historyIndex } = get();
    if (historyIndex > 0) {
      set({
        historyIndex: historyIndex - 1,
        resumeData: JSON.parse(JSON.stringify(history[historyIndex - 1])),
      });
    }
  },

  // Redo action
  redo: () => {
    const { history, historyIndex } = get();
    if (historyIndex < history.length - 1) {
      set({
        historyIndex: historyIndex + 1,
        resumeData: JSON.parse(JSON.stringify(history[historyIndex + 1])),
      });
    }
  },

  // Check if can undo/redo
  canUndo: () => get().historyIndex > 0,
  canRedo: () => get().historyIndex < get().history.length - 1,

  // Add a new section
  addSection: (sectionType) => {
    const { resumeData, saveToHistory } = get();
    saveToHistory();

    // Get fresh template with new UUIDs
    const freshTemplates = createSectionTemplates();
    const template = freshTemplates[sectionType];
    if (!template) return;

    const newSection = {
      id: uuidv4(),
      type: template.type,
      data: JSON.parse(JSON.stringify(template.data)),
    };

    set({
      resumeData: {
        ...resumeData,
        sections: [...resumeData.sections, newSection],
        sectionOrder: [...resumeData.sectionOrder, newSection.id],
      },
    });
  },

  // Remove a section
  removeSection: (sectionId) => {
    const { resumeData, saveToHistory } = get();
    const section = resumeData.sections.find((s) => s.id === sectionId);
    if (section?.locked) return; // Can't remove locked sections

    saveToHistory();

    set({
      resumeData: {
        ...resumeData,
        sections: resumeData.sections.filter((s) => s.id !== sectionId),
        sectionOrder: resumeData.sectionOrder.filter((id) => id !== sectionId),
      },
    });
  },

  // Reorder sections
  reorderSections: (newOrder) => {
    const { resumeData, saveToHistory } = get();
    saveToHistory();

    // Reorder sections array based on new order
    const reorderedSections = newOrder.map((id) =>
      resumeData.sections.find((s) => s.id === id)
    );

    set({
      resumeData: {
        ...resumeData,
        sections: reorderedSections,
        sectionOrder: newOrder,
      },
    });
  },

  // Update section data
  updateSectionData: (sectionId, newData) => {
    const { resumeData, saveToHistory } = get();
    saveToHistory();

    set({
      resumeData: {
        ...resumeData,
        sections: resumeData.sections.map((section) =>
          section.id === sectionId
            ? { ...section, data: { ...section.data, ...newData } }
            : section
        ),
      },
    });
  },

  // Update theme settings
  updateTheme: (themeUpdates) => {
    const { resumeData, saveToHistory } = get();
    saveToHistory();

    set({
      resumeData: {
        ...resumeData,
        theme: { ...resumeData.theme, ...themeUpdates },
      },
    });
  },

  // Change template
  changeTemplate: (templateId) => {
    const { resumeData, saveToHistory, templates } = get();
    if (!templates[templateId]) return;

    saveToHistory();

    // If switching to basic template, load the basic template data
    if (templateId === "basic") {
      const basicData = createBasicTemplateData();
      basicData.sectionOrder = basicData.sections.map((s) => s.id);
      set({ resumeData: basicData });
    } else if (templateId === "shraddha") {
      const shraddhaData = createShraddhaTemplateData();
      shraddhaData.sectionOrder = shraddhaData.sections.map((s) => s.id);
      set({ resumeData: shraddhaData });
    } else {
      set({
        resumeData: {
          ...resumeData,
          template: templateId,
        },
      });
    }
  },

  // Load a specific template with its data
  loadBasicTemplate: () => {
    const { saveToHistory } = get();
    saveToHistory();

    const basicData = createBasicTemplateData();
    basicData.sectionOrder = basicData.sections.map((s) => s.id);
    set({ resumeData: basicData });
  },

  loadShraddhaTemplate: () => {
    const { saveToHistory } = get();
    saveToHistory();

    const shraddhaData = createShraddhaTemplateData();
    shraddhaData.sectionOrder = shraddhaData.sections.map((s) => s.id);
    set({ resumeData: shraddhaData });
  },

  // Set active panel
  setActivePanel: (panel) => {
    set({ activePanel: panel });
  },

  // Set selected section
  setSelectedSection: (sectionId) => {
    set({ selectedSectionId: sectionId });
  },

  // Reset to default
  resetResume: () => {
    const { saveToHistory } = get();
    saveToHistory();

    set({
      resumeData: createInitialResumeData(),
      sectionTemplates: createSectionTemplates(),
    });
  },

  // Initialize history with current state
  initializeHistory: () => {
    const { resumeData } = get();
    set({
      history: [JSON.parse(JSON.stringify(resumeData))],
      historyIndex: 0,
    });
  },

  // ============================================
  // NEW TEMPLATE SYSTEM ACTIONS
  // ============================================

  // Confirmation dialog state
  confirmDialog: {
    isOpen: false,
    title: "",
    message: "",
    onConfirm: null,
    onCancel: null,
  },

  // Set confirmation dialog
  setConfirmDialog: (dialogState) => {
    set({ confirmDialog: { ...get().confirmDialog, ...dialogState } });
  },

  // Close confirmation dialog
  closeConfirmDialog: () => {
    set({
      confirmDialog: {
        isOpen: false,
        title: "",
        message: "",
        onConfirm: null,
        onCancel: null,
      },
    });
  },

  // Add item to a section (education, experience, projects, etc.)
  addItemToSection: (sectionType, newItem) => {
    const { resumeData, saveToHistory } = get();
    saveToHistory();

    const currentData = resumeData[sectionType] || [];
    const updatedData = Array.isArray(currentData)
      ? [...currentData, newItem]
      : currentData;

    set({
      resumeData: {
        ...resumeData,
        [sectionType]: updatedData,
      },
    });
  },

  // Remove item from a section
  removeItemFromSection: (sectionType, itemId) => {
    const { resumeData, saveToHistory } = get();
    saveToHistory();

    const currentData = resumeData[sectionType] || [];
    const updatedData = Array.isArray(currentData)
      ? currentData.filter((item) => item.id !== itemId)
      : currentData;

    set({
      resumeData: {
        ...resumeData,
        [sectionType]: updatedData,
      },
    });
  },

  // Update section settings (show/hide fields)
  updateSectionSettings: (sectionType, settings) => {
    const { resumeData, saveToHistory } = get();
    saveToHistory();

    const currentSettings = resumeData.sectionSettings || {};

    set({
      resumeData: {
        ...resumeData,
        sectionSettings: {
          ...currentSettings,
          [sectionType]: {
            ...(currentSettings[sectionType] || {}),
            ...settings,
          },
        },
      },
    });
  },

  // Get section settings
  getSectionSettings: (sectionType) => {
    const { resumeData } = get();
    return resumeData.sectionSettings?.[sectionType] || {};
  },

  // Add bullet to an item
  addBulletToItem: (sectionType, itemId) => {
    const { resumeData, saveToHistory } = get();
    saveToHistory();

    const currentData = resumeData[sectionType] || [];
    const updatedData = currentData.map((item) => {
      if (item.id === itemId) {
        return {
          ...item,
          bullets: [...(item.bullets || []), ""],
        };
      }
      return item;
    });

    set({
      resumeData: {
        ...resumeData,
        [sectionType]: updatedData,
      },
    });
  },

  // Remove bullet from an item
  removeBulletFromItem: (sectionType, itemId, bulletIndex) => {
    const { resumeData, saveToHistory } = get();
    saveToHistory();

    const currentData = resumeData[sectionType] || [];
    const updatedData = currentData.map((item) => {
      if (item.id === itemId) {
        const newBullets = [...(item.bullets || [])];
        newBullets.splice(bulletIndex, 1);
        return { ...item, bullets: newBullets };
      }
      return item;
    });

    set({
      resumeData: {
        ...resumeData,
        [sectionType]: updatedData,
      },
    });
  },

  // Update item date (for MonthYearPicker)
  updateItemDate: (sectionType, itemId, field, value) => {
    const { resumeData, saveToHistory } = get();
    saveToHistory();

    const currentData = resumeData[sectionType] || [];
    const updatedData = currentData.map((item) => {
      if (item.id === itemId) {
        return { ...item, [field]: value };
      }
      return item;
    });

    set({
      resumeData: {
        ...resumeData,
        [sectionType]: updatedData,
      },
    });
  },

  // Load template sample data (for new template system)
  loadTemplateSampleData: (templateId) => {
    const { saveToHistory } = get();
    saveToHistory();

    try {
      const sampleData = getTemplateSampleData(templateId);
      if (sampleData && Object.keys(sampleData).length > 0) {
        set({ resumeData: sampleData });
      }
    } catch (error) {
      console.warn("Could not load template sample data:", error);
    }
  },
}));

export default useBuildStore;
